{% extends 'base.html' %}
{% block content %}

<h2>ğŸ“„ ì£¼ê°„ë³´ê³  ìƒì„¸ë³´ê¸°</h2>

<section>
  <h3>ğŸ—“ï¸ ë³´ê³  ì£¼ê°„</h3>
  <p>{{ report.week_start.strftime('%Y-%m-%d') }} ~ {{ report.week_end.strftime('%m-%d') }}</p>
  <p>ì œì¶œ ìƒíƒœ: <strong>{{ report.status }}</strong></p>
  {% if report.submitted_at %}
    <p>ì œì¶œì¼ì‹œ: {{ report.submitted_at.strftime('%Y-%m-%d %H:%M') }}</p>
  {% endif %}
</section>

<hr>

<section>
  <h3>ğŸ“ í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸</h3>

  {% if report.project_updates %}
    {% for update in report.project_updates %}
      <div class="project-block">
        <h4>{{ update.project.solution_name }} - {{ update.project.project_name }}</h4>

        <div>
          <strong>ì§„í–‰ìƒí™©</strong>
          <pre>{{ update.progress or '-' }}</pre>
        </div>

        {% if update.issue %}
        <div>
          <strong>íŠ¹ì´ì‚¬í•­</strong>
          <pre>{{ update.issue }}</pre>
        </div>
        {% endif %}

        {% if update.sales_support %}
        <div>
          <strong>ì˜ì—…ì§€ì› ì‚¬í•­</strong>
          <pre>{{ update.sales_support }}</pre>
        </div>
        {% endif %}

        {% if update.other_note %}
        <div>
          <strong>ê·¸ ì™¸ íŠ¹ì´ì‚¬í•­</strong>
          <pre>{{ update.other_note }}</pre>
        </div>
        {% endif %}

        {% if diffs and update.project_id in diffs %}
          <details style="margin-top: 1rem;">
            <summary>ğŸ“Œ ì´ì „ ì£¼ê°„ê³¼ ë³€ê²½ì‚¬í•­ ë¹„êµ</summary>
            <pre>{{ diffs[update.project_id] }}</pre>
          </details>
        {% endif %}
      </div>
      <hr>
    {% endfor %}
  {% else %}
    <p style="color: var(--color-muted);">ë“±ë¡ëœ í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
  {% endif %}
</section>

<hr>

<section>
  <h3>ğŸ“† ê°œì¸ ì¼ì •</h3>

  {% if report.personal_schedules %}
    <table>
      <thead>
        <tr>
          <th>êµ¬ë¶„</th>
          <th>ì œëª©</th>
          <th>ì¥ì†Œ</th>
          <th>ì‹œì‘ì¼</th>
          <th>ì¢…ë£Œì¼</th>
          <th>ë¹„ê³ </th>
        </tr>
      </thead>
      <tbody>
        {% for s in report.personal_schedules %}
          <tr>
            <td>{{ s.category }}</td>
            <td>{{ s.title }}</td>
            <td>{{ s.location }}</td>
            <td>{{ s.start_date.strftime('%Y-%m-%d') }}</td>
            <td>{{ s.end_date.strftime('%Y-%m-%d') }}</td>
            <td>{{ s.description or '-' }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p style="color: var(--color-muted);">ë“±ë¡ëœ ê°œì¸ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</p>
  {% endif %}
</section>

<br>
<a href="{{ url_for('dashboard.index') }}"><button>â† ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°</button></a>

{% endblock %}
