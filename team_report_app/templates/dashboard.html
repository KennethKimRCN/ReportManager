<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>주간 보고서 대시보드</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <style>
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .dashboard-title {
      font-size: 1.8rem;
      font-weight: bold;
    }

    .filter {
      margin-left: auto;
    }

    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 1rem;
    }

    .report-card {
      background: #f9f9f9;
      border-radius: 12px;
      padding: 1.2rem;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      transition: transform 0.2s;
      cursor: pointer;
    }

    .report-card:hover {
      transform: scale(1.02);
    }

    .card-title {
      font-size: 1.2rem;
      font-weight: bold;
    }

    .card-meta {
      color: #666;
      margin-top: 0.5rem;
      font-size: 0.95rem;
    }

    .top-bar {
      display: flex;
      justify-content: flex-end;
      gap: 0.5rem;
      margin-bottom: 1.2rem;
    }

    .top-bar a {
      padding: 0.5rem 1rem;
      background: #007aff;
      color: white;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 500;
    }

    .top-bar a:hover {
      background: #005fce;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="dashboard-title">주간 보고서</div>
      <div class="top-bar">
        <a href="{{ url_for('submit') }}">+ 보고서 작성</a>
        <a href="#" id="open-create-project">+ 프로젝트 등록</a>
        <a href="{{ url_for('logout') }}">로그아웃</a>
      </div>
    </div>

    <div class="filter">
      <label for="week-filter">주차 필터:</label>
      <select id="week-filter" onchange="filterByWeek()">
        <option value="">전체</option>
        {% for week in weeks %}
          <option value="{{ week }}">{{ week }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="card-grid" id="report-grid">
      {% for report in reports %}
      <div class="report-card" onclick="location.href='{{ url_for('view_report', update_id=report.id) }}'">
        <div class="card-title">{{ report.user.name }}</div>
        <div class="card-meta">{{ report.user.position }} · {{ report.week }}</div>
      </div>
      {% endfor %}
    </div>
  </div>

  <!-- Optional: Future Modal for Project Create Popup -->
  <!-- We'll handle this later in JS -->

  <script>
    function filterByWeek() {
      const selected = document.getElementById('week-filter').value;
      const cards = document.querySelectorAll('.report-card');

      cards.forEach(card => {
        const meta = card.querySelector('.card-meta').textContent;
        if (selected === '' || meta.includes(selected)) {
          card.style.display = 'block';
        } else {
          card.style.display = 'none';
        }
      });
    }

    document.getElementById("open-create-project").addEventListener("click", function (e) {
      e.preventDefault();
      window.location.href = "{{ url_for('create_project') }}";
    });
  </script>
</body>
</html>
